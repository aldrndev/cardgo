<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="utf-8" />
    <meta httpEquiv="X-UA-Compatible" content="IE=edge" />

    <!-- Viewport Configuration -->
    <meta
      name="viewport"
      content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=5,viewport-fit=cover,user-scalable=yes"
    />

    <!-- Primary Meta Tags -->
    <title>Card Go - Credit Card Tracker</title>
    <meta name="title" content="Card Go - Credit Card Tracker" />
    <meta
      name="description"
      content="Lacak kartu kredit Anda dengan mudah dan aman. Offline-first, privacy-focused."
    />

    <!-- Theme Color -->
    <meta name="theme-color" content="#4F46E5" />
    <meta name="msapplication-TileColor" content="#4F46E5" />

    <!-- Web App Manifest -->
    <link rel="manifest" href="/manifest.json" />

    <!-- Favicons -->
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="/icons/icon-32x32.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="/icons/icon-16x16.png"
    />
    <link rel="shortcut icon" href="/favicon.ico" />

    <!-- iOS Specific Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="apple-mobile-web-app-title" content="Card Go" />

    <!-- Apple Touch Icons -->
    <link rel="apple-touch-icon" href="/icons/apple-touch-icon.png" />
    <link
      rel="apple-touch-icon"
      sizes="152x152"
      href="/icons/icon-152x152.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="/icons/apple-touch-icon.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="167x167"
      href="/icons/icon-167x167.png"
    />

    <!-- iOS Splash Screens (Optional - uncomment if you add splash images) -->
    <!--
    <link rel="apple-touch-startup-image" href="/splash/iphone5_splash.png" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2)" />
    <link rel="apple-touch-startup-image" href="/splash/iphone6_splash.png" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2)" />
    <link rel="apple-touch-startup-image" href="/splash/iphoneplus_splash.png" media="(device-width: 621px) and (device-height: 1104px) and (-webkit-device-pixel-ratio: 3)" />
    <link rel="apple-touch-startup-image" href="/splash/iphonex_splash.png" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3)" />
    <link rel="apple-touch-startup-image" href="/splash/iphonexr_splash.png" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2)" />
    <link rel="apple-touch-startup-image" href="/splash/iphonexsmax_splash.png" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3)" />
    <link rel="apple-touch-startup-image" href="/splash/ipad_splash.png" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2)" />
    <link rel="apple-touch-startup-image" href="/splash/ipadpro1_splash.png" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2)" />
    <link rel="apple-touch-startup-image" href="/splash/ipadpro3_splash.png" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2)" />
    <link rel="apple-touch-startup-image" href="/splash/ipadpro2_splash.png" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2)" />
    -->

    <!-- Disable tap highlight on IE -->
    <meta name="msapplication-tap-highlight" content="no" />

    <!-- Security -->
    <meta http-equiv="X-Content-Type-Options" content="nosniff" />

    <style>
      /* Loading Screen */
      #root-loading {
        display: flex;
        align-items: center;
        justify-content: center;
        height: 100vh;
        background-color: #ffffff;
      }

      .spinner {
        width: 50px;
        height: 50px;
        border: 4px solid #f3f4f6;
        border-top-color: #4f46e5;
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }

      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }

      /* Hide loading when app is ready */
      #root:not(:empty) ~ #root-loading {
        display: none;
      }
    </style>
  </head>
  <body>
    <noscript>
      <div style="padding: 20px; text-align: center; font-family: sans-serif">
        <h2>JavaScript Required</h2>
        <p>Card Go memerlukan JavaScript untuk berfungsi dengan baik.</p>
        <p>
          Mohon aktifkan JavaScript di browser Anda dan muat ulang halaman ini.
        </p>
      </div>
    </noscript>

    <!-- React Root -->
    <div id="root"></div>

    <!-- Loading Indicator -->
    <div id="root-loading">
      <div class="spinner"></div>
    </div>

    <!-- Service Worker Registration -->
    <script>
      if ("serviceWorker" in navigator) {
        window.addEventListener("load", () => {
          navigator.serviceWorker
            .register("/service-worker.js")
            .then((registration) => {
              console.log(
                "ServiceWorker registration successful:",
                registration.scope
              );

              // Check for updates
              registration.addEventListener("updatefound", () => {
                const newWorker = registration.installing;
                newWorker.addEventListener("statechange", () => {
                  if (
                    newWorker.state === "installed" &&
                    navigator.serviceWorker.controller
                  ) {
                    // New service worker available, prompt user to refresh
                    console.log("New version available! Please refresh.");
                  }
                });
              });
            })
            .catch((error) => {
              console.log("ServiceWorker registration failed:", error);
            });
        });
      }

      // Detect if running as PWA
      if (window.matchMedia("(display-mode: standalone)").matches) {
        console.log("Running as PWA");
        document.documentElement.classList.add("pwa-mode");
      }

      // iOS standalone mode detection
      if (window.navigator.standalone === true) {
        console.log("Running as iOS PWA");
        document.documentElement.classList.add("ios-pwa-mode");
      }
    </script>
  </body>
</html>
